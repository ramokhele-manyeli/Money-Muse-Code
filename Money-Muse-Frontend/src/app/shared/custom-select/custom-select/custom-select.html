<div class="custom-select">
  <div 
    class="select-trigger"
    [class.open]="isOpen"
    [class.focused]="isFocused"
    (click)="toggleDropdown($event)"
    (keydown)="onKeyDown($event)"
    (mousedown)="$event.preventDefault()"
    tabindex="0"
    [attr.aria-expanded]="isOpen"
    [attr.aria-haspopup]="true"
    role="combobox">
    <span class="select-value" [class.placeholder]="!selectedOption">
      {{ selectedOption?.label || placeholder }}
    </span>
    <lucide-icon 
      [name]="ChevronDown" 
      [size]="16" 
      class="select-arrow"
      [class.rotated]="isOpen">
    </lucide-icon>
  </div>
  
  <div 
    class="select-dropdown"
    [class.open]="isOpen"
    [style.display]="isOpen ? 'block' : 'none'"
    role="listbox">
    <div
      *ngFor="let option of options; trackBy: trackByValue"
      class="select-option"
      [class.selected]="selectedOption?.value === option.value"
      (click)="selectOption(option, $event)"
      (keydown)="onOptionKeyDown($event, option)"
      (mousedown)="$event.preventDefault()"
      role="option"
      [attr.aria-selected]="selectedOption?.value === option.value"
      tabindex="-1">
      {{ option.label }}
    </div>
  </div>
</div>